services:
  - type: web
    name: surfsup-shop
    env: docker
    dockerfilePath: Dockerfile
    dockerContext: .
    # Upgraded to Standard plan for better memory capacity
    # Starter plan: 512MB RAM (insufficient for Sylius - causes memory limit errors)
    # Standard plan: 2GB RAM (recommended for production)
    plan: standard
    region: oregon
    envVars:
      - key: APP_ENV
        value: prod
      - key: APP_SECRET
        generateValue: true
      - key: DATABASE_URL
        value: sqlite:////var/www/html/var/data.db
      - key: SYMFONY_ENV
        value: prod
      - key: COMPOSER_ALLOW_SUPERUSER
        value: "1"
      - key: PHP_MEMORY_LIMIT
        value: "128M"
      - key: SYMFONY_CACHE_WARMUP
        value: "0"
    healthCheckPath: /
    autoDeploy: true
